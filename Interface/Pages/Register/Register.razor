@page "/Register"
@using BusinessLogic
@using DepoQuick.Domain
@inject MemoryDataBase MemoryDataBase
@inject IJSRuntime JSRuntime


<html lang="es" xmlns="http://www.w3.org/1999/html">
  <head>
      <meta charset="utf-8"/>
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  </head>

    <body>

    <h3>¡Bienvenido!</h3>
    <form>
        <div class="form-group">
            <label for="name">Nombre:</label>
            <input type="text" class="form-control" id="name" @bind="_name" required />
        </div>
        <div class="form-group">
            <label for="email">Correo Electrónico:</label>
            <input type="email" class="form-control" id="email" @bind-value="_email" required />
        </div>
        <div class="form-group">
            <label for="password">Contraseña:</label>
            <input type="password" class="form-control" id="password" @bind-value="_password"required />
        </div>
        <div class="form-group">
                    <label for="password">Ingrese nuevamente la contraseña:</label>
                    <input type="password" class="form-control" id="passwordValidation"@bind-value="_passwordValidation" required />
                </div>
        <br><br/>
        <button type="submit" class="btn btn-primary" @onclick="RegisterUser">Registrarse</button>
        @if (registred) {
            <div class="alert alert-success" role="alert">
                El usuario ingresó correctamente
            </div>
        }
    </form>
    </body>
</html>

@code {
    bool registred = false;
    private Controller _controller;
    private String _name;
    private String _email;
    private String _password;
    private String _passwordValidation;
    
        
    public void RegisterUser()
    {
        _controller = new Controller(MemoryDataBase);
        if (_controller.GetAdministrator() != null)
        {
            _controller.RegisterAdministrator(_name,_email,_password,_passwordValidation);
        }
        else
        {
            _controller.RegisterClient(_name,_email,_password,_passwordValidation);
        }
        
        //TODO: Ver si queremos analizar de alguna forma en especifico que el usuario se haya ingresado correctamente
        registred = true;
    }
    
}